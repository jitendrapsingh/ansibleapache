- name: deploy webserver
  hosts: all
  user: root
  become: true
  tasks:
  - name: install httpd
    yum:
     name: httpd
     state: latest
 
  - name: check file stat
    stat:
     path: /var/www/html/index.html
    register: xyz
  
  - name: create  index.html
    copy:
     content: "{{ ansible_hostname }}" 
     dest: /var/www/html/index.html
    when: xyz.stat.exists  == false 

  - name: append  index.html
    lineinfile:
     line: "{{ ansible_hostname }}" 
     dest: /var/www/html/index.html
    when: xyz.stat.exists  == true



 
  - name: start and enable httpd
    service:
     name: httpd
     state: started
     enabled: true
